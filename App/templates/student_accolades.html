{% extends "student_layout.html" %}
{% set active_tab = 'accolades' %}

{% block title %}Student Accolades{% endblock %}

{% block styles %}
<style>
  .accolades-wrapper {
    max-width: 1100px;
    margin: 30px auto;
    background: #ffffff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    padding: 24px 32px;
    border-radius: 4px;
  }

  .gradient-card {
    background: linear-gradient(135deg, #6fc3ff, #3b82d6);
    border-radius: 4px;
    padding: 16px 20px;
    color: #ffffff;
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    margin-bottom: 20px;
  }

  .gradient-card h5,
  .gradient-card h6,
  .gradient-card p,
  .gradient-card span {
    color: #ffffff;
    margin-top: 0;
  }

  .inner-panel {
    background: rgba(0,0,0,0.25);
    border-radius: 16px;
    padding: 14px 18px;
    margin-top: 10px;
  }

  .recent-milestones {
    max-height: 180px;
    overflow-y: auto;
    margin-top: 8px;
  }

  .milestone-item {
    padding: 6px 0;
    border-bottom: 1px solid rgba(255,255,255,0.35);
    font-size: 0.95rem;
  }

  .milestone-item:last-child {
    border-bottom: none;
  }

  .milestone-item a {
    color: #e0f7ff;
    font-size: 0.9rem;
  }

  .progress {
    background-color: rgba(255,255,255,0.25);
  }

  .progress .determinate {
    background-color: #81c784;
  }

  .badge-circle {
    display: inline-block;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background-color: #ffe082;
    margin-right: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }

  @media (max-width: 600px) {
    .accolades-wrapper {
      padding: 16px 18px;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="accolades-wrapper">
  <div class="row">
    
    <div class="col s12 m6">
      <h5>{{ current_user.student_id if current_user else "StudentID" }} Accolades</h5>

      
      <div class="gradient-card">
        <h6>Recent Milestones</h6>

        <div class="recent-milestones">
          {% for m in recent_milestones|sort(attribute='achieved_at', reverse=True) %}
            <div class="milestone-item">
              <div>
                <strong>{{ m.name }}</strong>
                {% if m.hours_required %}
                  – {{ m.hours_required }} hours
                {% endif %}
              </div>
              {% if m.achieved_at %}
                <small>Achieved: {{ m.achieved_at.strftime('%d %b %Y') }}</small>
              {% endif %}
              <div>
                <a href="{{ url_for('index_views.student_accolades_page', milestone_id=m.id) }}">
                  View details
                </a>
              </div>
            </div>
          {% else %}
            <p>No milestones achieved yet.</p>
          {% endfor %}
        </div>
      </div>

      
      <div class="gradient-card">
        <h6>In Progress – {{ progress_percent }}% Completed</h6>
        <p style="margin-bottom: 6px;">
          {{ next_milestone.name if next_milestone else "Next milestone" }}
          {% if next_milestone and next_milestone.hours_required %}
            – Achieve {{ next_milestone.hours_required }} hours
          {% endif %}
        </p>
        <div class="progress">
          <div class="determinate" style="width: {{ progress_percent }}%;"></div>
        </div>
      </div>
    </div>

    
    <div class="col s12 m6">
      <h5>Accolade Details</h5>

    
      <div class="gradient-card">
        <div class="inner-panel">
          {% if selected_milestone %}
            <h6>{{ selected_milestone.name }} Milestone</h6>
            {% if selected_milestone.hours_required %}
              <p><strong>Requirement:</strong> Achieve {{ selected_milestone.hours_required }} hours</p>
            {% endif %}
            <p>{{ selected_milestone.description or "No extra description provided." }}</p>
          {% else %}
            <p>Select a milestone from the list on the left to view its details.</p>
          {% endif %}
        </div>
      </div>

      
      <div class="gradient-card">
        <h6>Accolades Awarded</h6>
        <div class="inner-panel">
          {% if awarded_accolades %}
            {% for a in awarded_accolades %}
              <a href="{{ url_for('index_views.student_accolades_page', accolade_id=a.id) }}"
                 title="{{ a.name }}">
                <span class="badge-circle"></span>
              </a>
            {% endfor %}
          {% else %}
            <p>No accolades awarded yet.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
